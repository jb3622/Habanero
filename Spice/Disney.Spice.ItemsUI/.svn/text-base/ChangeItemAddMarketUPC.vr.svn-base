Using System
Using System.Collections
Using System.ComponentModel
Using System.Data
Using System.Drawing
Using System.Text
Using System.Windows.Forms
Using Disney.Spice.ItemsBO  

BegClass ChangeItemAddMarketUPC Extends(System.Windows.Forms.Form) Access(*Public)

/Region Default Windows Form Designer generated code 
	
	DclFld label25 System.Windows.Forms.Label                Access(*Private)  WithEvents(*Yes)
	DclFld groupBox1 System.Windows.Forms.GroupBox           Access(*Private)  WithEvents(*Yes)
	DclFld lblSize System.Windows.Forms.Label                Access(*Private)  WithEvents(*Yes)
	DclFld lbl4 System.Windows.Forms.Label                   Access(*Private)  WithEvents(*Yes)
	DclFld lblMarket System.Windows.Forms.Label              Access(*Private)  WithEvents(*Yes)
	DclFld lbl1 System.Windows.Forms.Label                   Access(*Private)  WithEvents(*Yes)
	DclFld lbl5 System.Windows.Forms.Label                   Access(*Private)  WithEvents(*Yes)
	DclFld lblVendor System.Windows.Forms.Label              Access(*Private)  WithEvents(*Yes)
	DclFld lblClass System.Windows.Forms.Label               Access(*Private)  WithEvents(*Yes)
	DclFld lbl3 System.Windows.Forms.Label                   Access(*Private)  WithEvents(*Yes)
	DclFld lbl2 System.Windows.Forms.Label                   Access(*Private)  WithEvents(*Yes)
	DclFld lblSizeDesc System.Windows.Forms.Label            Access(*Private)  WithEvents(*Yes)
	DclFld lblLongDesc System.Windows.Forms.Label            Access(*Private)  WithEvents(*Yes)
	DclFld lblVendorDesc System.Windows.Forms.Label          Access(*Private)  WithEvents(*Yes)
	DclFld lblClassDesc System.Windows.Forms.Label           Access(*Private)  WithEvents(*Yes)
	DclFld btnHelp System.Windows.Forms.Button               Access(*Internal) WithEvents(*Yes)
	DclFld btnCancel System.Windows.Forms.Button             Access(*Internal) WithEvents(*Yes)
	DclFld btnOK System.Windows.Forms.Button                 Access(*Internal) WithEvents(*Yes)
	DclFld txtVendorUPC System.Windows.Forms.TextBox         Access(*Private)  WithEvents(*Yes)
	DclFld errorProvider System.Windows.Forms.ErrorProvider  Access(*Private)  WithEvents(*Yes)
	DclFld components Type(System.ComponentModel.IContainer) Inz(*Nothing)
	
	BegSr InitializeComponent
		*this.components = *new System.ComponentModel.Container()
		*this.lblSize = *new System.Windows.Forms.Label()
		*this.lblSizeDesc = *new System.Windows.Forms.Label()
		*this.lbl4 = *new System.Windows.Forms.Label()
		*this.lblMarket = *new System.Windows.Forms.Label()
		*this.lbl1 = *new System.Windows.Forms.Label()
		*this.lblLongDesc = *new System.Windows.Forms.Label()
		*this.lbl5 = *new System.Windows.Forms.Label()
		*this.lblVendor = *new System.Windows.Forms.Label()
		*this.lblClass = *new System.Windows.Forms.Label()
		*this.lblVendorDesc = *new System.Windows.Forms.Label()
		*this.lblClassDesc = *new System.Windows.Forms.Label()
		*this.lbl3 = *new System.Windows.Forms.Label()
		*this.lbl2 = *new System.Windows.Forms.Label()
		*this.btnCancel = *new System.Windows.Forms.Button()
		*this.btnHelp = *new System.Windows.Forms.Button()
		*this.btnOK = *new System.Windows.Forms.Button()
		*this.label25 = *new System.Windows.Forms.Label()
		*this.txtVendorUPC = *new System.Windows.Forms.TextBox()
		*this.groupBox1 = *new System.Windows.Forms.GroupBox()
		*this.errorProvider = *new System.Windows.Forms.ErrorProvider(*this.components)
		*this.groupBox1.SuspendLayout()
		(*this.errorProvider *As System.ComponentModel.ISupportInitialize).BeginInit()
		*this.SuspendLayout()
		//
		//lblSize
		//
		*this.lblSize.AutoSize = *True
		*this.lblSize.Font = *new System.Drawing.Font("Microsoft Sans Serif", 8.25, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, (0 *As System.Byte))
		*this.lblSize.Location = *new System.Drawing.Point(55, 77)
		*this.lblSize.Name = "lblSize"
		*this.lblSize.Size = *new System.Drawing.Size(39, 13)
		*this.lblSize.TabIndex = 625
		*this.lblSize.Text = "XXXX"
		//
		//lblSizeDesc
		//
		*this.lblSizeDesc.AutoSize = *True
		*this.lblSizeDesc.Location = *new System.Drawing.Point(108, 77)
		*this.lblSizeDesc.Name = "lblSizeDesc"
		*this.lblSizeDesc.Size = *new System.Drawing.Size(182, 13)
		*this.lblSizeDesc.TabIndex = 624
		*this.lblSizeDesc.Text = "XXXXXXXXXXXXXXXXXXXXXXXXX"
		//
		//lbl4
		//
		*this.lbl4.AutoSize = *True
		*this.lbl4.Location = *new System.Drawing.Point(10, 77)
		*this.lbl4.Name = "lbl4"
		*this.lbl4.Size = *new System.Drawing.Size(27, 13)
		*this.lbl4.TabIndex = 623
		*this.lbl4.Text = "Size"
		//
		//lblMarket
		//
		*this.lblMarket.AutoSize = *True
		*this.lblMarket.Font = *new System.Drawing.Font("Microsoft Sans Serif", 8.25, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, (0 *As System.Byte))
		*this.lblMarket.Location = *new System.Drawing.Point(52, 15)
		*this.lblMarket.Name = "lblMarket"
		*this.lblMarket.Size = *new System.Drawing.Size(23, 13)
		*this.lblMarket.TabIndex = 622
		*this.lblMarket.Text = "XX"
		//
		//lbl1
		//
		*this.lbl1.AutoSize = *True
		*this.lbl1.Location = *new System.Drawing.Point(9, 15)
		*this.lbl1.Name = "lbl1"
		*this.lbl1.Size = *new System.Drawing.Size(45, 13)
		*this.lbl1.TabIndex = 621
		*this.lbl1.Text = "Markets"
		//
		//lblLongDesc
		//
		*this.lblLongDesc.AutoSize = *True
		*this.lblLongDesc.Location = *new System.Drawing.Point(108, 99)
		*this.lblLongDesc.Name = "lblLongDesc"
		*this.lblLongDesc.Size = *new System.Drawing.Size(182, 13)
		*this.lblLongDesc.TabIndex = 620
		*this.lblLongDesc.Text = "XXXXXXXXXXXXXXXXXXXXXXXXX"
		//
		//lbl5
		//
		*this.lbl5.AutoSize = *True
		*this.lbl5.Location = *new System.Drawing.Point(10, 99)
		*this.lbl5.Name = "lbl5"
		*this.lbl5.Size = *new System.Drawing.Size(87, 13)
		*this.lbl5.TabIndex = 619
		*this.lbl5.Text = "Long Description"
		//
		//lblVendor
		//
		*this.lblVendor.AutoSize = *True
		*this.lblVendor.Font = *new System.Drawing.Font("Microsoft Sans Serif", 8.25, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, (0 *As System.Byte))
		*this.lblVendor.Location = *new System.Drawing.Point(52, 56)
		*this.lblVendor.Name = "lblVendor"
		*this.lblVendor.Size = *new System.Drawing.Size(47, 13)
		*this.lblVendor.TabIndex = 618
		*this.lblVendor.Text = "XXXXX"
		//
		//lblClass
		//
		*this.lblClass.AutoSize = *True
		*this.lblClass.Font = *new System.Drawing.Font("Microsoft Sans Serif", 8.25, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, (0 *As System.Byte))
		*this.lblClass.Location = *new System.Drawing.Point(52, 35)
		*this.lblClass.Name = "lblClass"
		*this.lblClass.Size = *new System.Drawing.Size(39, 13)
		*this.lblClass.TabIndex = 617
		*this.lblClass.Text = "XXXX"
		//
		//lblVendorDesc
		//
		*this.lblVendorDesc.AutoSize = *True
		*this.lblVendorDesc.Location = *new System.Drawing.Point(108, 56)
		*this.lblVendorDesc.Name = "lblVendorDesc"
		*this.lblVendorDesc.Size = *new System.Drawing.Size(182, 13)
		*this.lblVendorDesc.TabIndex = 616
		*this.lblVendorDesc.Text = "XXXXXXXXXXXXXXXXXXXXXXXXX"
		//
		//lblClassDesc
		//
		*this.lblClassDesc.AutoSize = *True
		*this.lblClassDesc.Location = *new System.Drawing.Point(108, 35)
		*this.lblClassDesc.Name = "lblClassDesc"
		*this.lblClassDesc.Size = *new System.Drawing.Size(182, 13)
		*this.lblClassDesc.TabIndex = 615
		*this.lblClassDesc.Text = "XXXXXXXXXXXXXXXXXXXXXXXXX"
		//
		//lbl3
		//
		*this.lbl3.AutoSize = *True
		*this.lbl3.Location = *new System.Drawing.Point(10, 56)
		*this.lbl3.Name = "lbl3"
		*this.lbl3.Size = *new System.Drawing.Size(41, 13)
		*this.lbl3.TabIndex = 614
		*this.lbl3.Text = "Vendor"
		//
		//lbl2
		//
		*this.lbl2.AutoSize = *True
		*this.lbl2.Location = *new System.Drawing.Point(10, 35)
		*this.lbl2.Name = "lbl2"
		*this.lbl2.Size = *new System.Drawing.Size(32, 13)
		*this.lbl2.TabIndex = 613
		*this.lbl2.Text = "Class"
		//
		//btnCancel
		//
		*this.btnCancel.Location = *new System.Drawing.Point(250, 195)
		*this.btnCancel.Name = "btnCancel"
		*this.btnCancel.Size = *new System.Drawing.Size(75, 23)
		*this.btnCancel.TabIndex = 4
		*this.btnCancel.Text = "Cancel"
		*this.btnCancel.UseVisualStyleBackColor = *True
		//
		//btnHelp
		//
		*this.btnHelp.Location = *new System.Drawing.Point(10, 195)
		*this.btnHelp.Name = "btnHelp"
		*this.btnHelp.Size = *new System.Drawing.Size(75, 23)
		*this.btnHelp.TabIndex = 2
		*this.btnHelp.Text = "Help"
		*this.btnHelp.UseVisualStyleBackColor = *True
		//
		//btnOK
		//
		*this.btnOK.Location = *new System.Drawing.Point(165, 195)
		*this.btnOK.Name = "btnOK"
		*this.btnOK.Size = *new System.Drawing.Size(75, 23)
		*this.btnOK.TabIndex = 3
		*this.btnOK.Text = "OK"
		*this.btnOK.UseVisualStyleBackColor = *True
		//
		//label25
		//
		*this.label25.AutoSize = *True
		*this.label25.Location = *new System.Drawing.Point(20, 20)
		*this.label25.Name = "label25"
		*this.label25.Size = *new System.Drawing.Size(66, 13)
		*this.label25.TabIndex = 629
		*this.label25.Text = "Vendor UPC"
		//
		//txtVendorUPC
		//
		*this.txtVendorUPC.Location = *new System.Drawing.Point(98, 16)
		*this.txtVendorUPC.Name = "txtVendorUPC"
		*this.txtVendorUPC.Size = *new System.Drawing.Size(83, 20)
		*this.txtVendorUPC.TabIndex = 1
		//
		//groupBox1
		//
		*this.groupBox1.Controls.Add(*this.label25)
		*this.groupBox1.Controls.Add(*this.txtVendorUPC)
		*this.groupBox1.Location = *new System.Drawing.Point(10, 126)
		*this.groupBox1.Name = "groupBox1"
		*this.groupBox1.Size = *new System.Drawing.Size(315, 53)
		*this.groupBox1.TabIndex = 0
		*this.groupBox1.TabStop = *False
		//
		//errorProvider
		//
		*this.errorProvider.ContainerControl = *this
		//
		//ChangeItemAddMarketUPC
		//
		*this.AutoScaleDimensions = *new System.Drawing.SizeF(6, 13)
		*this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font
		*this.ClientSize = *new System.Drawing.Size(334, 233)
		*this.Controls.Add(*this.groupBox1)
		*this.Controls.Add(*this.btnOK)
		*this.Controls.Add(*this.lblSize)
		*this.Controls.Add(*this.lblSizeDesc)
		*this.Controls.Add(*this.lbl4)
		*this.Controls.Add(*this.lblMarket)
		*this.Controls.Add(*this.lbl1)
		*this.Controls.Add(*this.lblLongDesc)
		*this.Controls.Add(*this.lbl5)
		*this.Controls.Add(*this.lblVendor)
		*this.Controls.Add(*this.lblClass)
		*this.Controls.Add(*this.lblVendorDesc)
		*this.Controls.Add(*this.lblClassDesc)
		*this.Controls.Add(*this.lbl3)
		*this.Controls.Add(*this.lbl2)
		*this.Controls.Add(*this.btnCancel)
		*this.Controls.Add(*this.btnHelp)
		*this.MaximizeBox = *False
		*this.MinimizeBox = *False
		*this.Name = "ChangeItemAddMarketUPC"
		*this.SizeGripStyle = System.Windows.Forms.SizeGripStyle.Hide
		*this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent
		*this.Text = "SPICE - Change Item - Add Market UPC"
		*this.groupBox1.ResumeLayout(*False)
		*this.groupBox1.PerformLayout()
		(*this.errorProvider *As System.ComponentModel.ISupportInitialize).EndInit()
		*this.ResumeLayout(*False)
		*this.PerformLayout()
	EndSr
		
	BegSr Dispose Access(*Protected) Modifier(*Overrides)
		DclSrParm disposing Type(*Boolean)

		If (disposing *And (components *NE *Nothing))
			components.Dispose()
		EndIf
			
		*Base.Dispose(disposing)
	EndSr

/Endregion

/Region Constructor	
	BegConstructor Access(*Public)
		DclSrParm PgmDB       Type(ASNA.VisualRPG.Runtime.Database)
		DclSrParm ItemsBO     Type(Disney.Spice.ItemsBO.Items)
		DclSrParm Environment Type(Disney.Menu.Environments)
				
		InitializeComponent()
		
		ErrPro = *New Disney.Spice.ErrorProvider.ErrorProviderWithCount(*this.components)
		ErrPro.BlinkStyle = System.Windows.Forms.ErrorBlinkStyle.NeverBlink
		ErrPro.ContainerControl = *this
		
		*This.PgmDB       = PgmDB
		*This.ItemsBO     = ItemsBO
		*This.Environment = Environment
		
	EndConstructor
/EndREgion

/Region Declares    
	DclFld PgmDB       Type(ASNA.VisualRPG.Runtime.Database)
	DclFld Environment Type(Disney.Menu.Environments)
	DclFld ErrPro      Type(Disney.Spice.ErrorProvider.ErrorProviderWithCount) 
	DclFld ItemsBO     Type(Disney.Spice.ItemsBO.Items)  
	DclFld args        Type(System.ComponentModel.CancelEventArgs)  
/EndRegion

/Region Properties
	
	DclFld pMarket Type(String) Access(*Private) Inz(String.Empty)
	BegProp Market Type(String) Access(*Public)
		BegGet
			LeaveSR pMarket
		EndGet
		BegSet
			pMarket = *PropVal
		EndSet
	EndProp
	
	DclFld pClass Type(String) Access(*Private) Inz(String.Empty)
	BegProp Class Type(String) Access(*Public)
		BegGet
			LeaveSR pClass
		EndGet
		BegSet
			pClass = *PropVal
		EndSet
	EndProp
	
	DclFld pClassDesc Type(String) Access(*Private) Inz(String.Empty)
	BegProp ClassDesc Type(String) Access(*Public)
		BegGet
			LeaveSR pClassDesc
		EndGet
		BegSet
			pClassDesc = *PropVal
		EndSet
	EndProp
	
	DclFld pVendor Type(String) Access(*Private) Inz(String.Empty)
	BegProp Vendor Type(String) Access(*Public)
		BegGet
			LeaveSR pVendor
		EndGet
		BegSet
			pVendor = *PropVal
		EndSet
	EndProp
	
	DclFld pVendorDesc Type(String) Access(*Private) Inz(String.Empty)
	BegProp VendorDesc Type(String) Access(*Public)
		BegGet
			LeaveSR pVendorDesc
		EndGet
		BegSet
			pVendorDesc = *PropVal
		EndSet
	EndProp
	
	DclFld pSize Type(Int16) Access(*Private) Inz(0)
	BegProp Size Type(Int16) Access(*Public)
		BegGet
			LeaveSR pSize
		EndGet
		BegSet
			pSize = *PropVal
		EndSet
	EndProp
	
	DclFld pSizeDesc Type(String) Access(*Private) Inz(String.Empty)
	BegProp SizeDesc Type(String) Access(*Public)
		BegGet
			LeaveSR pSizeDesc
		EndGet
		BegSet
			pSizeDesc = *PropVal
		EndSet
	EndProp
	
	DclFld pLongDescription Type(String) Access(*Private) Inz(String.Empty)
	BegProp LongDescription Type(String) Access(*Public)
		BegGet
			LeaveSR pLongDescription
		EndGet
		BegSet
			pLongDescription = *PropVal
		EndSet
	EndProp

	DclFld pLocalDescription Type(String) Access(*Private) Inz(String.Empty)
	BegProp LocalDescription Type(String) Access(*Public)
		BegGet
			LeaveSR pLocalDescription
		EndGet
		BegSet
			pLocalDescription = *PropVal
		EndSet
	EndProp
		
	DclFld pVendorUPC Type(String) Access(*Private) Inz(String.Empty)
	BegProp VendorUPC Type(String) Access(*Public)
		BegGet
			LeaveSR pVendorUPC
		EndGet
		BegSet
			pVendorUPC = *PropVal
		EndSet
	EndProp
/EndRegion

/Region Methods	
	BegSr FormLoadEvent Access(*Private) Event(*this.Load)
		DclSrParm sender *Object
		DclSrParm e System.EventArgs
        
        lblMarket.Text      = Market
        lblClass.Text       = Class
        lblClassDesc.Text   = ClassDesc
        lblVendor.Text      = Vendor
        lblVendorDesc.Text  = VendorDesc
        lblSize.Text        = Size
        lblSizeDesc.Text    = SizeDesc
        lblLongDesc.Text    = LongDescription 
        
        txtVendorUPC.Select()
        btnOK.Enabled = *False	   
		
	EndSr
		
	BegSr txtVendorUPC_Validating Access(*Private) Event(*this.txtVendorUPC.Validating)
		DclSrParm sender *Object
		DclSrParm e System.ComponentModel.CancelEventArgs
				
		DclFld UPC           Type(Int64)
		DclFld UPCCheckDigit Type(Boolean)
								
		ErrPro.SetControlError(sender *As Control,String.Empty)
		If Not String.IsNullOrEmpty(txtVendorUPC.Text)
			Try
				UPC = Convert.ToInt64(txtVendorUPC.Text)
			Catch Name(Err) Type(System.Exception)
				ErrPro.SetControlError(txtVendorUPC,'Invalid number')
				LeaveSR
			EndTry
			
			//Calculate UPC Checkdigit
			UPCCheckDigit =  ItemsBO.ChkUPCcheckDigit(UPC)
			If	UPCcheckDigit = *False
				ErrPro.SetControlError(txtVendorUPC,'UPC CheckDigit not valid, Please correct.')
				LeaveSR
			EndIf
			
			// Check that the UPC is unique on IPITHDR for the Market Specified
			If ItemsBO.ChkUPCUniqueMarket(UPC,Market)
				ErrPro.SetControlError(txtVendorUPC,'Entered UPC already exists in selected Market')
				LeaveSR
			EndIf
			
			// Check that the UPC is unique on DSSPIMI for the Market Specified
			If ItemsBO.ChkUPCuniqueIMI(UPC,Market)
				ErrPro.SetControlError(txtVendorUPC,'Entered UPC already exists in selected Market')
				LeaveSR
			EndIf
			
			Else
				ErrPro.SetControlError(txtVendorUPC,'Please enter a valid UPC')
				LeaveSR
		EndIf
	EndSr
	
	BegSr txtVendorUPC_Leave Access(*Private) Event(*this.txtVendorUPC.Leave)
		DclSrParm sender *Object
		DclSrParm e System.EventArgs
				
		args = *New System.ComponentModel.CancelEventArgs()
		txtVendorUPC_Validating(txtVendorUPC,args)
		
		If ErrPro.ErrorCount = *Zero
			btnOK.Enabled = *True
		Endif
		
	EndSr
/EndRegion

/Region Buttons
	BegSr btnHelp_Click Access(*Private) Event(*this.btnHelp.Click)
		DclSrParm sender *Object
		DclSrParm e System.EventArgs
		
		OsExec CmdLine("iexplore http://teamshareemea.emea.wdpr.disney.com/dcpsites/spice/SpiceUserManual/Pages/default.aspx")
		
	EndSr
	
	BegSr btnOK_Click Access(*Private) Event(*this.btnOK.Click)
		DclSrParm sender *Object
		DclSrParm e System.EventArgs
		
		*This.ValidateChildren()
		
		If txtVendorUPC.Text <> String.Empty 
			pVenDorUPC = txtVendorUPC.Text
			*This.DialogResult = DialogResult.OK
		EndIf
		
	EndSr
	
	BegSr btnCancel_Click Access(*Private) Event(*this.btnCancel.Click)
		DclSrParm sender *Object
		DclSrParm e System.EventArgs
		
		ErrPro.SetControlError(sender *As Control,String.Empty)
		*This.DialogResult = DialogResult.Cancel
		
	EndSr
/EndRegion	
	
EndClass
